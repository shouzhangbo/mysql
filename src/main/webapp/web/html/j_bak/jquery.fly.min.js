/* fly - v1.0.0 - 2014-12-22
* https://github.com/amibug/fly
* Copyright (c) 2014 wuyuedong; Licensed MIT */
!function(A){A.fly=function(D,E){var B={version:"1.0.0",autoPlay:!0,vertex_Rtop:20,speed:1.2,start:{},end:{},onEnd:A.noop},C=this,F=A(D);C.init=function(G){this.setOptions(G),!!this.settings.autoPlay&&this.play()},C.setOptions=function(N){this.settings=A.extend(!0,{},B,N);var O=this.settings,G=O.start,P=O.end;F.css({marginTop:"0px",marginLeft:"0px",position:"fixed"}).appendTo("body"),null!=P.width&&null!=P.height&&A.extend(!0,G,{width:F.width(),height:F.height()});var J=Math.min(G.top,P.top)-Math.abs(G.left-P.left)/3;J<O.vertex_Rtop&&(J=Math.min(O.vertex_Rtop,Math.min(G.top,P.top)));var K=Math.sqrt(Math.pow(G.top-P.top,2)+Math.pow(G.left-P.left,2)),H=Math.ceil(Math.min(Math.max(Math.log(K)/0.05-75,30),100)/O.speed),I=G.top==J?0:-Math.sqrt((P.top-J)/(G.top-J)),L=(I*G.left-P.left)/(I-1),M=P.left==L?0:(P.top-J)/Math.pow(P.left-L,2);A.extend(!0,O,{count:-1,steps:H,vertex_left:L,vertex_top:J,curvature:M})},C.play=function(){this.move()},C.move=function(){var N=this.settings,O=N.start,Q=N.count,G=N.steps,P=N.end,J=O.left+(P.left-O.left)*Q/G,K=0==N.curvature?O.top+(P.top-O.top)*Q/G:N.curvature*Math.pow(J-N.vertex_left,2)+N.vertex_top;if(null!=P.width&&null!=P.height){var H=G/2,I=P.width-(P.width-O.width)*Math.cos(H>Q?0:(Q-H)/(G-H)*Math.PI/2),L=P.height-(P.height-O.height)*Math.cos(H>Q?0:(Q-H)/(G-H)*Math.PI/2);F.css({width:I+"px",height:L+"px","font-size":Math.min(I,L)+"px"})}F.css({left:J+"px",top:K+"px"}),N.count++;var M=window.requestAnimationFrame(A.proxy(this.move,this));Q==G&&(window.cancelAnimationFrame(M),N.onEnd.apply(this))},C.destory=function(){F.remove()},C.init(E)},A.fn.fly=function(B){return this.each(function(){void 0==A(this).data("fly")&&A(this).data("fly",new A.fly(this,B))})}}(jQuery);